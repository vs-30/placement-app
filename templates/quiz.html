{% extends "layout.html" %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Question Cards</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3e8ff;
      padding: 20px;
    }
    .question-card {
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      padding: 20px;
      margin-bottom: 20px;
    }
    .question-title {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
      color: #333;
    }
    .question-text {
      font-size: 16px;
      margin-bottom: 15px;
      color: #555;
    }
    .choices {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .choice label {
      cursor: pointer;
      font-size: 15px;
      padding: 8px 12px;
      border-radius: 8px;
      transition: background 0.2s;
    }
    .choice input[type="radio"] {
      margin-right: 8px;
    }
    .choice:hover {
      background: #f0f0f0;
    }
    #resultModal {
      display: none; /* hidden by default */
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    #resultModalContent {
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      font-size: 18px;
      font-weight: bold;
      color: #2d3436;
    }
    #closeBtn {
      margin-top: 20px;
      padding: 10px 20px;
      background: #6c5ce7;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Q1 -->
  <div class="question-card">
    <div class="question-title">1. Problem Solving Style</div>
    <div class="question-text">When given a new coding challenge, what excites you more?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q1" value="a"> Writing efficient logic and algorithms</label>
      <label class="choice"><input type="radio" name="q1" value="b"> Finding errors and fixing bugs</label>
      <label class="choice"><input type="radio" name="q1" value="c"> Analyzing data to discover patterns</label>
      <label class="choice"><input type="radio" name="q1" value="d"> Thinking of smart AI-based solutions</label>
    </div>
  </div>

  <!-- Q2 -->
  <div class="question-card">
    <div class="question-title">2. Favorite Academic Area</div>
    <div class="question-text">Which subject do you enjoy the most?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q2" value="a"> Data Structures & Algorithms</label>
      <label class="choice"><input type="radio" name="q2" value="b"> Software Testing / Quality Assurance</label>
      <label class="choice"><input type="radio" name="q2" value="d"> Machine Learning / AI</label>
      <label class="choice"><input type="radio" name="q2" value="a"> Web Development</label>
    </div>
  </div>

  <!-- Q3 -->
  <div class="question-card">
    <div class="question-title">3. Project Preference</div>
    <div class="question-text">In a team project, which part do you love to handle?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q3" value="a"> Core coding & feature building</label>
      <label class="choice"><input type="radio" name="q3" value="b"> Debugging and testing the system</label>
      <label class="choice"><input type="radio" name="q3" value="c"> Handling databases and reports</label>
      <label class="choice"><input type="radio" name="q3" value="d"> Designing smart/automated modules</label>
    </div>
  </div>

  <!-- Q4 -->
  <div class="question-card">
    <div class="question-title">4. Work Satisfaction</div>
    <div class="question-text">Which gives you more satisfaction?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q4" value="a"> Seeing my program run successfully</label>
      <label class="choice"><input type="radio" name="q4" value="b"> Catching hidden bugs that nobody else finds</label>
      <label class="choice"><input type="radio" name="q4" value="c"> Turning raw data into meaningful insights</label>
      <label class="choice"><input type="radio" name="q4" value="d"> Building a model that predicts outcomes correctly</label>
    </div>
  </div>

  <!-- Q5 -->
  <div class="question-card">
    <div class="question-title">5. Thinking Style</div>
    <div class="question-text">How do you usually approach a technical problem?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q5" value="a"> Step-by-step logical coding</label>
      <label class="choice"><input type="radio" name="q5" value="b"> Test different cases until it breaks</label>
      <label class="choice"><input type="radio" name="q5" value="c"> Collect and analyze data before deciding</label>
      <label class="choice"><input type="radio" name="q5" value="d"> Train a machine to learn from the data</label>
    </div>
  </div>

  <!-- Q6 -->
  <div class="question-card">
    <div class="question-title">6. Tool Preference</div>
    <div class="question-text">Which tools/technologies do you like working with?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q6" value="a"> Programming languages (C, C++, Java, Python)</label>
      <label class="choice"><input type="radio" name="q6" value="b"> Testing tools (Selenium, JUnit)</label>
      <label class="choice"><input type="radio" name="q6" value="c"> Databases & analytics (SQL, Power BI, Hadoop)</label>
      <label class="choice"><input type="radio" name="q6" value="d"> AI/ML libraries (TensorFlow, PyTorch)</label>
    </div>
  </div>

  <!-- Q7 -->
  <div class="question-card">
    <div class="question-title">7. Career Motivation</div>
    <div class="question-text">What motivates you most?</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q7" value="a"> Building software that people use daily</label>
      <label class="choice"><input type="radio" name="q7" value="b"> Delivering error-free, high-quality systems</label>
      <label class="choice"><input type="radio" name="q7" value="c"> Helping businesses make data-driven decisions</label>
      <label class="choice"><input type="radio" name="q7" value="d"> Creating intelligent systems that think/learn</label>
    </div>
  </div>

  <!-- Q8 -->
  <div class="question-card">
    <div class="question-title">8. Workplace Vision</div>
    <div class="question-text">In your dream IT job, you would:</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q8" value="a"> Develop new applications/software</label>
      <label class="choice"><input type="radio" name="q8" value="b"> Ensure product quality with testing</label>
      <label class="choice"><input type="radio" name="q8" value="c"> Analyze large datasets and reports</label>
      <label class="choice"><input type="radio" name="q8" value="d"> Build AI-driven solutions</label>
    </div>
  </div>

  <!-- Q9 Final -->
  <div class="question-card">
    <div class="question-title">9. Future Goal</div>
    <div class="question-text">In 5 years, you want to be known as:</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="qFinal" value="Software Developer / Full Stack Developer"> A full-stack/software developer</label>
      <label class="choice"><input type="radio" name="qFinal" value="QA Engineer / Automation Tester"> A quality assurance/testing expert</label>
      <label class="choice"><input type="radio" name="qFinal" value="Data Analyst / Business Analyst"> A data analyst / database engineer</label>
      <label class="choice"><input type="radio" name="qFinal" value="AI/ML Engineer / Data Scientist"> An AI/ML engineer</label>
    </div>
  </div>

  <!-- Q10 -->
  <div class="question-card">
    <div class="question-title">10. Extra Interest</div>
    <div class="question-text">If given free time to explore, you would:</div>
    <div class="choices">
      <label class="choice"><input type="radio" name="q10" value="a"> Join coding competitions (Codeforces, LeetCode)</label>
      <label class="choice"><input type="radio" name="q10" value="b"> Practice bug hunting / debugging challenges</label>
      <label class="choice"><input type="radio" name="q10" value="c"> Analyze open datasets (Kaggle, data portals)</label>
      <label class="choice"><input type="radio" name="q10" value="d"> Experiment with AI/ML projects (chatbots, vision)</label>
    </div>
  </div>

  <!-- Submit -->
  <button id="submitBtn" style="margin-top: 20px; padding: 12px 20px; background: #6c5ce7; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-size: 16px;">Submit</button>

  <div id="resultModal">
    <div id="resultModalContent">
      <div id="resultMessage"></div>
      <button id="closeBtn">Close</button>
    </div>
  </div>

  <script>
    document.getElementById("submitBtn").addEventListener("click", async function () {
      const answers = {};
      const counts = { a: 0, b: 0, c: 0, d: 0 };

      // Collect selected answers
      document.querySelectorAll("input[type=radio]:checked").forEach((input) => {
        let qName = input.name;
        let value = input.value;
        answers[qName] = value;

        // Count only a/b/c/d answers (not qFinal)
        if (["a", "b", "c", "d"].includes(value)) {
          counts[value]++;
        }
      });

      // Find majority
      let maxLetter = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);

      // Map suggested role
      let suggested = "";
      if (maxLetter === "a") suggested = "Software Developer / Full Stack Developer";
      if (maxLetter === "b") suggested = "QA Engineer / Automation Tester";
      if (maxLetter === "c") suggested = "Data Analyst / Business Analyst";
      if (maxLetter === "d") suggested = "AI/ML Engineer / Data Scientist";

      let preferred = answers["qFinal"];
      let finalMessage = "";

      if (preferred === suggested) {
        finalMessage = `You want to be a ${preferred}, and your answers confirm that this path suits you well!`;
      } else {
        finalMessage = `You want to be a ${preferred} — great choice! Based on your answers, we think you’d also be a strong fit for ${suggested}.`;
      }

      document.getElementById("resultMessage").innerText = finalMessage;
      document.getElementById("resultModal").style.display = "flex";

      // Save to backend (Flask + MongoDB)
      const response = await fetch("/save_results", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          answers: answers,
          preferred: preferred,
          suggested: suggested,
          finalMessage: finalMessage
        })
      });

      if (response.ok) {
        console.log("Saved to MongoDB!");
      } else {
        console.error("Error saving to DB");
      }
    });

    document.getElementById("closeBtn").addEventListener("click", function () {
      document.getElementById("resultModal").style.display = "none";
    });

    window.onload = function() {
      document.getElementById("resultModal").style.display = "none";
    };
  </script>
</body>
</html>
{% endblock %}
